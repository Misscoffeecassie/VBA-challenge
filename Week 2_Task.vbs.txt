Sub Stockdata()Dim ws As Worksheet    'Set an initial variable for holding the Ticker Name    Dim Ticker_Name As String        'Set an intial variable for holding Total Vol    Dim Total_Vol As LongLong    Total_Vol = 0        'Set an intial variable for holding Open Price    Dim Open_Price As Double        'Set an intial variable for holding Close Price    Dim Close_Price As Double        'Set an intial variable for holding Yearly Change    Dim Y_Change As Double        'Set an intial variable for holding Percentage Change    Dim P_Change As Double         'Count duplicate numbers of each Ticker     Dim j As Integer        'Loop through all sheets    For Each ws In ThisWorkbook.Worksheets           'Keep track the location for each Ticker in the summary table    Dim Ticker_Location As Integer    Ticker_Location = 2        'Determine the Last Row    lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row        'Add the word Ticker to the First Column Header    ws.Range("I1").Value = "Ticker"     'Add the word Yearly Change to the First Column Header    ws.Range("J1").Value = "Yearly Change"     'Add the word Percent Change to the First Column Header    ws.Range("K1").Value = "Percent Change"     'Add the word Total Stock Volume to the First Column Header    ws.Range("L1").Value = "Total Stock Volume"          'Loop through all tickers        For i = 2 To lastrow                    'Check if we are still within the same ticker, if not...          If ws.Cells(i, 1).Value <> ws.Cells(i + 1, 1).Value Then                        'Set the Ticker Name            Ticker_Name = ws.Cells(i, 1).Value                        'Set Open Price for Tickers            Open_Price = ws.Cells((i - j), 3).Value                        'Set Close Price for Tickers            Close_Price = ws.Cells(i, 6).Value                        'Add Yealy Change value            Y_Change = Close_Price - Open_Price                    'Add Percentage Change value            P_Change = Y_Change / Open_Price                        'Add to Total Vol            Total_Vol = Total_Vol + ws.Cells(i, 7).Value                                    'Print Ticker Name in the summary Table            ws.Range("I" & Ticker_Location).Value = Ticker_Name                         'Print Yearly Change in the summary Table            ws.Range("J" & Ticker_Location).Value = Format(Y_Change, "0.00#")                        'Print Percentage Change in the summary Table            ws.Range("K" & Ticker_Location).Value = Format(P_Change, "0.00%")                         'Print Total Vol in the summary Table            ws.Range("L" & Ticker_Location).Value = Total_Vol                        'Add one to Summary Table            Ticker_Location = Ticker_Location + 1                        'Reset count duplicate number for each Ticker            j = 0                        'Reset Ticker Total Vol            Total_Vol = 0                    Else             'Add to Total Vol            Total_Vol = Total_Vol + ws.Cells(i, 7).Value                        'Add count number            j = j + 1                        End If                    Next i                 'Determine the last row of the new summary table     lastrowsummary = ws.Cells(Rows.Count, 9).End(xlUp).Row        'Format Yearly Change with highlighting positive change in green and negative change in red     For a = 2 To lastrowsummary            If ws.Cells(a, 10).Value > 0 Then            ws.Cells(a, 10).Interior.ColorIndex = 4                   Else            ws.Cells(a, 10).Interior.ColorIndex = 3           End If        Next a                    Next ws    End SubSub bonus()'Bonus to find Greatest Increse, Greatest Decrease, Greatest Total Volume      'Set an initial variable for holding the lats row numbers of the summary table   Dim NL_row As Integer       'Set an initial variable for holding the maximum value in the percent change of the summary table   Dim Max_Pchange As Double      'Set an initial variable for holding the minimum value in the percent change of the summary table   Dim Min_Pchange As Double      Dim ws As Worksheet         For Each ws In ThisWorkbook.Worksheets    'Determine the Last Row of total Ticker Column I    NL_row = ws.Cells(Rows.Count, 9).End(xlUp).Row            'Add the row's category title in the summary table            ws.Range("O2").Value = "Greatest % Increase"        ws.Range("O3").Value = "Greatest % Decrease"        ws.Range("O4").Value = "Greatest Total Volume"            'Add the Column's category title in the summary table        ws.Range("P1").Value = "Ticker"        ws.Range("Q1").Value = "Value"                   'Find the maximum value in the percent change with built-in function Max        Max_Pchange = Application.WorksheetFunction.Max(Range("K2:K" & NL_row))        Range("Q2").Value = Format(Max_Pchange, "0.00%")             'Find the minimum value in the percent change with built-in function Min        Min_Pchange = Application.WorksheetFunction.Min(Range("K2:K" & NL_row))        Range("Q3").Value = Format(Min_Pchange, "0.00%")                'Find the Greatest Total Volume with built-in function Max        Range("Q4").Value = Application.WorksheetFunction.Max(Range("L2:L" & NL_row))             'Locate and output the Ticker's name accordingly            For t = 2 To NL_row                        If Range("K" & t).Value = Max_Pchange Then                Range("P2").Value = Range("I" & t).Value            Else                        End If                         If Range("K" & t).Value = Min_Pchange Then                Range("P3").Value = Range("I" & t).Value            Else                            End If                            If Range("L" & t).Value = Range("Q4").Value Then            Range("P4").Value = Range("I" & t).Value            Else                        End If                        Next t                Next wsEnd Sub